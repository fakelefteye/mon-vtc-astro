---
import Layout from '../layouts/Layout.astro';

// Liste des stations de Ben's Bus à intégrer pour les forfaits aéroport
const newStations = [
    { destination: "Alpe d'Huez", cp: "38750", lyonPrix: 350, gnbPrix: 250 },
    { destination: "Les Deux Alpes", cp: "38520", lyonPrix: 380, gnbPrix: 280 },
    { destination: "Tignes / Val d'Isère", cp: "73320", lyonPrix: 480, gnbPrix: 520 },
    { destination: "Les Menuires / St. Martin de Belleville", cp: "73440", lyonPrix: 420, gnbPrix: 460 },
    { destination: "Val Thorens / Orelle", cp: "73440", lyonPrix: 450, gnbPrix: 490 },
    { destination: "Méribel / Courchevel", cp: "73120", lyonPrix: 450, gnbPrix: 490 },
    { destination: "Val Cenis", cp: "73480", lyonPrix: 490, gnbPrix: 530 },
    { destination: "La Plagne / Les Arcs (Bourg St Maurice)", cp: "73700", lyonPrix: 450, gnbPrix: 490 },
    { destination: "Serre Chevalier (Briançon)", cp: "05240", lyonPrix: 450, gnbPrix: 390 },
    { destination: "Montgenèvre", cp: "05100", lyonPrix: 550, gnbPrix: 490 },
    { destination: "Risoul / Vars", cp: "05600", lyonPrix: 550, gnbPrix: 490 },
    { destination: "Chamrousse", cp: "38410", lyonPrix: 250, gnbPrix: 150 },
    { destination: "Saint-François-Longchamp", cp: "73130", lyonPrix: 350, gnbPrix: 390 },
    { destination: "Puy Saint Vincent", cp: "05290", lyonPrix: 490, gnbPrix: 450 },
    { destination: "Les Orres", cp: "05200", lyonPrix: 520, gnbPrix: 490 },
];

// NOUVEAU: Villes du Trièves (Monestier-de-Clermont est la principale)
const trievesStations = [
    { destination: "Monestier-de-Clermont", cp: "38650", lyonPrix: 320, gnbPrix: 190 },
    { destination: "Sinard", cp: "38650", lyonPrix: 330, gnbPrix: 200 },
    { destination: "Roissard", cp: "38650", lyonPrix: 310, gnbPrix: 180 },
    { destination: "Clelles", cp: "38930", lyonPrix: 340, gnbPrix: 210 },
];

// Forfaits originaux (Grenoble ↔ Station)
const forfaitsGrenoble = [
    { destination: "La Grave", cp: "05320", prixBerline: 207 },
    { destination: "Orcières", cp: "05170", prixBerline: 350 },
    { destination: "Serre Chevalier", cp: "05240", prixBerline: 390 },
    { destination: "Alpe d'Huez", cp: "38750", prixBerline: 170 },
    { destination: "Alpe du Grand Serre", cp: "38350", prixBerline: 150 },
    { destination: "Auris-en-Oisans", cp: "38142", prixBerline: 185 },
    { destination: "Autrans", cp: "38880", prixBerline: 116 },
    { destination: "Chamrousse", cp: "38410", prixBerline: 99 },
    { destination: "Col d'Ornon", cp: "38520", prixBerline: 163 },
    { destination: "Col de porte", cp: "38700", prixBerline: 90 },
    { destination: "Gresse-en-Vercors", cp: "38650", prixBerline: 134 },
    { destination: "Lans-en-Vercors", cp: "38250", prixBerline: 87 },
    { destination: "Le Collet D'Allevard", cp: "38580", prixBerline: 147 },
    { destination: "Le Sappey-en-Chartreuse", cp: "38700", prixBerline: 50 },
    { destination: "Les 7 Laux - Prapoutel (38190)", prixBerline: 106 },
    { destination: "Les Deux Alpes", cp: "38520", prixBerline: 180 },
    { destination: "Méaudre", cp: "38112", prixBerline: 120 },
    { destination: "Oz-en-Oisans", cp: "38114", prixBerline: 150 },
    { destination: "Saint-Hilaire-du-Touvet", cp: "38660", prixBerline: 76 },
    { destination: "Saint-Pierre-de-Chartreuse", cp: "38380", prixBerline: 79 },
    { destination: "Sanctuaire Notre-Dame de la Salette", cp: "38970", prixBerline: 221 },
    { destination: "Vaujany", cp: "38114", prixBerline: 154 },
    { destination: "Villard-Reculas", cp: "38114", prixBerline: 160 },
    { destination: "Villard-de-Lans", cp: "38250", prixBerline: 108 },
    { destination: "Courchevel", cp: "73120", prixBerline: 317 }
];

// Combine les stations de ski et les villes du Trièves pour les forfaits aéroport
const allAirportStations = [...newStations, ...trievesStations];


// Création des forfaits Aéroport Lyon ↔ Stations/Villes
const forfaitsLyon = allAirportStations.map(s => ({
    type: "Lyon LYS ↔",
    destination: s.destination,
    cp: s.cp,
    prixBerline: s.lyonPrix
}));

// Création des forfaits Aéroport Grenoble ↔ Stations/Villes
const forfaitsGrenobleAeroport = allAirportStations.map(s => ({
    type: "Grenoble GNB ↔",
    destination: s.destination,
    cp: s.cp,
    prixBerline: s.gnbPrix
}));


// Fusion des listes pour l'affichage
const allForfaits = [
    ...forfaitsLyon.sort((a, b) => a.destination.localeCompare(b.destination)),
    ...forfaitsGrenobleAeroport.sort((a, b) => a.destination.localeCompare(b.destination)),
    ...forfaitsGrenoble.sort((a, b) => a.destination.localeCompare(b.destination)),
];

// Fonction pour générer le JSON-LD Schema.org pour chaque forfait
const generateSchema = (forfaits) => {
    return forfaits.map(forfait => ({
        "@context": "https://schema.org",
        "@type": "Service",
        "serviceType": `Transfert VTC ${forfait.type || 'Grenoble ↔'} ${forfait.destination}`,
        "name": `Forfait VTC ${forfait.type || 'Grenoble ↔'} ${forfait.destination} (${forfait.cp})`,
        // Mise à jour de la description pour inclure tous les mots-clés
        "description": `Transfert VTC assuré par une chauffeure femme en berline 100% électrique haut de gamme (sièges chauffants, sécurité EuroNCAP) entre ${forfait.type ? forfait.type.replace('↔', 'et').replace('LYS', 'Aéroport Lyon').replace('GNB', 'Aéroport Grenoble') : 'Grenoble et'} ${forfait.destination}.`,
        "provider": {
            "@type": "Organization",
            "name": "Votre Compagnie VTC Grenoble"
        },
        "areaServed": [
            { "@type": "City", "name": forfait.type ? forfait.type.split(' ')[0] : "Grenoble" },
            { "@type": "Place", "address": { "@type": "PostalAddress", "postalCode": forfait.cp, "addressLocality": forfait.destination } }
        ],
        "offers": {
            "@type": "Offer",
            "priceCurrency": "EUR",
            "price": forfait.prixBerline.toFixed(2),
            "validFrom": new Date().toISOString().split('T')[0],
            "url": `/#booking?pickup=${forfait.type ? forfait.type.split(' ')[0] : 'Grenoble'}&dropoff=${encodeURIComponent(forfait.destination)}`
        }
    }));
};

const schemaData = generateSchema(allForfaits);
---

<Layout 
    title="Nos Forfaits VTC Fixes | Tarifs Stations de Ski, Trièves et Transferts Aéroports"
    description="Consultez nos tarifs VTC forfaitaires et fixes. Service assuré par une chauffeure femme en berline 100% électrique (EuroNCAP, sièges chauffants) pour les Alpes, le Trièves et les transferts aéroport.">

    <section class="page-hero">
        <div class="container">
            <h1>Tous nos Forfaits & Tarifs Fixes</h1>
            <p class="subtitle">Votre transfert premium assuré par une **chauffeure femme** en **berline 100% électrique** (sécurité EuroNCAP, sièges chauffants). Prix transparents et sans surprise.</p>
        </div>
    </section>

    <section class="content-section">
        <div class="container">
            
            <h2>Transferts Aéroports & Forfaits Trièves</h2>

            <p>Ces tarifs sont **indicatifs** (pour un trajet en berline) et vous permettent de comparer nos prix face aux taxis traditionnels. Ils incluent désormais les transferts directs depuis et vers les aéroports de **Lyon Saint-Exupéry (LYS)** et **Grenoble Alpes Isère (GNB)** vers les principales villes du **Trièves** et les **Stations des Alpes**. Pour obtenir le prix exact et instantané de votre course (en prenant en compte l'horaire, le trafic, et le véhicule), utilisez notre outil de réservation en haut de la page.</p>
            
            <div class="table-container">
                <table class="tarifs-table">
                    <thead>
                        <tr>
                            <th>Trajet VTC (Départ ↔ Arrivée)</th>
                            <th>Code Postal Destination</th>
                            <th>Prix Berline Électrique (4 pers.)</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        {allForfaits.map((forfait) => (
                            <tr>
                                <td data-label="Trajet" style="font-weight: 600;">
                                    {forfait.type ? forfait.type.replace('LYS', 'Aéroport Lyon').replace('GNB', 'Aéroport Grenoble') : 'Grenoble ↔'} {forfait.destination}
                                </td>
                                <td data-label="Code Postal">{forfait.cp}</td>
                                <td data-label="Berline" class="prix-berline">{forfait.prixBerline} €</td>
                                <td data-label="Réserver">
                                    <a 
                                        href={`/#booking?pickup=${forfait.type ? forfait.type.split(' ')[0] : 'Grenoble'}&dropoff=${forfait.destination}`} 
                                        class="table-cta" 
                                        title={`Estimer le trajet ${forfait.type ? forfait.type.split(' ')[0] : 'Grenoble'} ↔ ${forfait.destination}`}
                                    >
                                        Estimer / Réserver
                                    </a>
                                </td>
                            </tr>
                        ))}
                    </tbody>
                </table>
            </div>

            <p class="note">**Note :** Les tarifs de nuit, dimanches et jours fériés peuvent être majorés. Ces forfaits vous sont confirmés lors de la réservation en ligne.</p>

        </div>
    </section>
    
    <script type="application/ld+json" set:html={JSON.stringify(schemaData)} />

</Layout>

<style>
    /* Styles spécifiques pour la page Forfaits */
    :root {
        --accent: #007bff; 
        --primary-text: #333;
        --secondary-bg: #f5f5f5;
    }
    .page-hero {
        background: var(--accent);
        color: white;
        padding: 4rem 2rem;
        text-align: center;
    }
    .page-hero h1 {
        font-size: clamp(2em, 4vw, 3em);
        margin-bottom: 0.5rem;
    }
    .subtitle {
        font-size: 1.2em;
        opacity: 0.9;
    }
    .content-section {
        padding: 4rem 2rem;
    }
    .container {
        max-width: 1200px;
        margin: 0 auto;
    }
    
    /* Styles pour le tableau (UX et lisibilité mobile) */
    .table-container {
        overflow-x: auto;
        margin-top: 2rem;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        border-radius: 8px;
    }
    .tarifs-table {
        width: 100%;
        border-collapse: collapse;
        text-align: left;
        background: white;
    }
    .tarifs-table th, .tarifs-table td {
        padding: 15px;
        border-bottom: 1px solid #eee;
    }
    .tarifs-table th {
        background-color: var(--accent);
        color: white;
        font-weight: bold;
        text-transform: uppercase;
        font-size: 0.9em;
    }
    .tarifs-table tbody tr:hover {
        background-color: #f9f9f9;
    }
    .prix-berline {
        font-weight: bold;
        color: var(--accent);
    }
    
    /* Bouton CTA dans le tableau */
    .table-cta {
        display: inline-block;
        padding: 5px 12px;
        background-color: #f0f0f0;
        color: var(--accent);
        text-decoration: none;
        border-radius: 4px;
        font-size: 0.9em;
        font-weight: 600;
        transition: background-color 0.2s;
    }
    .table-cta:hover {
        background-color: var(--accent);
        color: white;
    }
    
    .note {
        margin-top: 2rem;
        font-style: italic;
        color: #666;
    }

    /* Rendre le tableau lisible sur mobile (styles responsives) */
    @media (max-width: 768px) {
        .tarifs-table, .tarifs-table thead, .tarifs-table tbody, .tarifs-table th, .tarifs-table td, .tarifs-table tr {
            display: block;
        }
        .tarifs-table thead tr {
            position: absolute;
            top: -9999px;
            left: -9999px;
        }
        .tarifs-table td {
            border: none;
            border-bottom: 1px solid #eee;
            position: relative;
            padding-left: 50%;
            text-align: right;
        }
        .tarifs-table td:before {
            position: absolute;
            top: 50%;
            left: 15px;
            width: 45%;
            padding-right: 10px;
            white-space: nowrap;
            content: attr(data-label);
            font-weight: bold;
            text-align: left;
            transform: translateY(-50%);
        }
        .tarifs-table td:nth-child(3) { /* Prix */
            background-color: var(--secondary-bg);
        }
        .table-cta {
            width: 100%;
            text-align: center;
        }
    }
</style>